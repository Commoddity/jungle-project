/* malevic@0.16.3 - Jul 22, 2019 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("malevic/dom"),require("malevic/string")):"function"==typeof define&&define.amd?define(["exports","malevic/dom","malevic/string"],n):n(((t=t||self).Malevic=t.Malevic||{},t.Malevic.Animation={}),t.Malevic.DOM,t.Malevic.String)}(this,function(t,i,o){"use strict";var r=function(){return(r=Object.assign||function(t){for(var n,e=1,i=arguments.length;e<i;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};function a(t){return null!=(n=t)&&"object"==typeof n&&Object.getPrototypeOf(t)===Object.prototype;var n}function g(t,n){return void 0===n&&(n=0),t[t.length-1-n]}function l(t,n,e){return n*(1-t)+e*t}var u=function(n,e){return function(t){return l(t,n,e)}};function n(t){for(var n,e=[],i=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[e][-+]?\d+)?/gim;n=i.exec(t);)e.push({index:n.index,length:n[0].length});return e}var s=function(r,o){var u=n(r),a=n(o);return function(t){for(var n="",e=0,i=0;i<a.length;i++)n+=o.substring(e,a[i].index),n+=l(t,parseFloat(r.substr(u[i].index,u[i].length)),parseFloat(o.substr(a[i].index,a[i].length))).toString(),e=a[i].index+a[i].length;return n+=o.substring(e)}};function e(t){return t}var c={delay:0,duration:250,easing:"ease"},p=function(){function t(){this.$spec={initial:null,timeline:[],interpolate:null,output:e}}return t.prototype.initial=function(t){return this.$spec.initial=t,this},t.prototype.from=function(t){if(0<this.$spec.timeline.length)throw new Error("Starting keyframe was already declared");return this.$spec.timeline.push({from:t,to:null,timing:r({},c)}),this},t.prototype.to=function(t,n){this.$spec.interpolate||("number"==typeof t?this.$spec.interpolate=u:"string"==typeof t&&(this.$spec.interpolate=s));var e=g(this.$spec.timeline);return e&&null==e.to?(e.to=t,n&&(e.timing=r({},e.timing,n))):this.$spec.timeline.push({from:e?e.to:null,to:t,timing:r({},c,n||{})}),this},t.prototype.interpolate=function(t){return this.$spec.interpolate=t,this},t.prototype.output=function(t){return this.$spec.output=t,this},t.prototype.spec=function(){return this.$spec},t}();function f(t,n,e){if(null!=e&&""!==e){var i=String(e),r="";i.endsWith("!important")&&(i=i.substring(0,i.length-10),r="important"),t.style.setProperty(n,i,r)}else t.style.removeProperty(n)}var y={linear:function(t){return t},ease:function(t){var n=(1-Math.cos(t*Math.PI))/2,e=Math.sqrt(1-Math.pow(t-1,2)),i=Math.sin(t*Math.PI/2);return n*(1-i)+e*i},"ease-in":function(t){var n=1-Math.cos(t*Math.PI/2);return 1-1e-15<n?1:n},"ease-out":function(t){return Math.sin(t*Math.PI/2)},"ease-in-out":function(t){return(1-Math.cos(t*Math.PI))/2}},h=function(){function t(t,n){if(!t.interpolate)throw new Error("No interpolator provided");this.interpolate=t.interpolate,this.output=t.output,this.callback=n;var r=0;this.timeline=t.timeline.map(function(t){var n=r,e=n+t.timing.delay,i=e+t.timing.duration;return{standby:n,start:e,end:r=i,spec:t,interpolate:null}}),this.isComplete=!1}return t.prototype.tick=function(t){null==this.startTime&&(this.startTime=t);for(var n,e=t-this.startTime,i=this.timeline,r=i.length-1;0<=r;r--){var o=i[r],u=o.standby,a=o.end;if(a<=e||u<=e&&e<=a){n=i[r];break}}var l=n.start,s=n.end,c=n.spec;n===g(i)&&s<=e&&(this.isComplete=!0),n.interpolate||(n.interpolate=this.interpolate(c.from,c.to));var f,p,h,m=("string"==typeof c.timing.easing?y[c.timing.easing]:c.timing.easing)(e<l?0:l===s?1:(f=(e-l)/(s-l),p=0,h=1,Math.min(h,Math.max(p,f)))),v=n.interpolate.call(null,m);this.lastValue=v;var d=this.output.call(null,v);this.callback.call(null,d)},t.prototype.value=function(){return this.lastValue},t.prototype.complete=function(){return this.isComplete},t}();var m=function(){var n=null,t=null,e=!1,i=[];function r(){n=performance.now(),i.forEach(function(t){return t(n)}),e&&(t=requestAnimationFrame(r))}return{run:function(){e=!0,n=performance.now(),t=requestAnimationFrame(r)},stop:function(){cancelAnimationFrame(t),n=t=null,e=!1},tick:function(t){i.push(t)},time:function(){return n},running:function(){return e}}}();function v(t,n){t.tick(n),t.complete()&&M(t)}m.tick(function(n){return Array.from(b.values()).forEach(function(t){return v(t,n)})});var d=new WeakMap,b=new Set;function M(t){b.delete(t),0===b.size&&m.stop()}function O(t){var n=d.get(t);return n&&b.has(n)?n:null}function j(t){return a(t)&&Object.values(t).some(function(t){return t instanceof p})}function w(t,n,e){var i,r,o,u,a,l=t.spec(),s=l.timeline[0].from,c=g(l.timeline).to;if(n instanceof p){var f=O(n);if(f)M(f),i=f.value();else i=g(n.spec().timeline).to}else typeof n==typeof c&&null!=n&&null!=c&&n.constructor===c.constructor&&(i=n);(null!=s?r=s:null!=i?r=i:null!=l.initial&&(r=l.initial),null==r)?e(l.output(c)):(l.timeline[0].from=r,u=e,a=new h((o=t).spec(),u),b.add(a),d.set(o,a),!m.running()&&m.run(),v(a,m.time()))}function k(t){if(t instanceof p){var n=O(t);n&&M(n)}}var A=function(t){var n=t.element,e=t.attr,i=t.value,r=t.prev;return i instanceof p?(w(i,r,function(t){return n.setAttribute(e,t)}),!0):(j(r)?Object.values(r).forEach(function(t){return k(t)}):k(r),null)},$=function(t){var r=t.element,n=t.attr,e=t.value,i=t.prev;if("style"===n){if(j(e)){var o,u=e;return a(i)?(o=i,Object.keys(o).filter(function(t){return!u.hasOwnProperty(t)}).forEach(function(t){k(o[t]),f(r,t,null)})):(o={},r.removeAttribute("style"),k(i)),Object.entries(u).forEach(function(t){var n=t[0],e=t[1],i=o[n];e instanceof p?w(e,i,function(t){f(r,n,t)}):(k(i),f(r,n,e))}),!0}j(i)&&Object.values(i).forEach(function(t){return k(t)})}return null};function x(t){return t.output(null!=t.timeline[0].from?t.timeline[0].from:null!=t.initial?t.initial:g(t.timeline).to)}var P=function(t){var n=t.value;if(n instanceof p){var e=n.spec();return o.escapeHTML(String(x(e)))}return null},E=function(t){var n,e=t.attr,i=t.value;if("style"===e&&j(i)){var r={};return Object.keys(i).forEach(function(t){var n=i[t];if(n instanceof p){var e=n.spec();r[t]=x(e)}else r[t]=n}),o.escapeHTML((n=r,Object.keys(n).filter(function(t){return null!=n[t]}).map(function(t){return t+": "+n[t]+";"}).join(" ")))}return null};t.animate=function(t,n){var e=new p;return null!=t&&e.to(t,n),e},t.withAnimation=function(t){if(i){var n=i.plugins;n.setAttribute.add(t,A),n.setAttribute.add(t,$)}if(o){var e=o.plugins;e.stringifyAttribute.add(t,P),e.stringifyAttribute.add(t,E)}return t},Object.defineProperty(t,"__esModule",{value:!0})});
