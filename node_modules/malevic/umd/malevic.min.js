/* malevic@0.16.3 - Jul 22, 2019 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).Malevic={})}(this,function(t){"use strict";function h(t){return null!=t&&"object"==typeof t}function a(t){return h(t)&&Object.getPrototypeOf(t)===Object.prototype}function m(t,e){return void 0===e&&(e=0),t[t.length-1-e]}function c(t){return h(t)&&null!=t.type&&null==t.nodeType}function i(t){return c(t)&&"string"==typeof t.type}function o(t){return c(t)&&"function"==typeof t.type}function e(){var o=[];return{add:function(t){return o.push(t),this},apply:function(t){for(var e,n,r=new Set,i=o.length-1;0<=i;i--)if(n=o[i],!r.has(n)){if(null!=(e=n(t)))return e;r.add(n)}return null},delete:function(t){for(var e=o.length-1;0<=e;e--)if(o[e]===t){o.splice(e,1);break}return this},empty:function(){return 0===o.length}}}function n(r,t,i){t.filter(function(t){var e=t[0];return r[e]}).forEach(function(t){var e=t[0],n=t[1];return r[e].forEach(function(t){return i(n,t)})})}function s(t,e){n(t,e,function(t,e){return t.add(e)})}function p(t,e){n(t,e,function(t,e){return t.delete(e)})}function r(n){var r={add:function(t,e){return t[n]||(t[n]=[]),t[n].push(e),r}};return r}var u=Symbol(),l=e();function d(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=[];return t.filter(function(t){return Boolean(t)}).forEach(function(e){"string"==typeof e?n.push(e):"object"==typeof e&&n.push.apply(n,Object.keys(e).filter(function(t){return Boolean(e[t])}))}),n.join(" ")}function f(e){return Object.keys(e).filter(function(t){return null!=e[t]}).map(function(t){return t+": "+e[t]+";"}).join(" ")}function v(t,e,n){if(null!=n&&""!==n){var r=String(n),i="";r.endsWith("!important")&&(r=r.substring(0,r.length-10),i="important"),t.style.setProperty(e,r,i)}else t.style.removeProperty(e)}var y=new WeakMap;function g(e,t){var n=new Map,r=new Set(Object.keys(e));return Object.keys(t).filter(function(t){return!r.has(t)}).forEach(function(t){return n.set(t,null)}),r.forEach(function(t){return n.set(t,e[t])}),n}function w(t,e,n){var r,i,o,u,a,s,c;"function"==typeof n?(u=t,a=e,s=n,y.has(u)?c=y.get(u):(c=new Map,y.set(u,c)),c.get(a)!==s&&(c.has(a)&&u.removeEventListener(a,c.get(a)),u.addEventListener(a,s),c.set(a,s))):(r=t,i=e,o=y.get(r),r.removeEventListener(i,o.get(i)),o.delete(i))}var E=new Set(["key","attached","detached","updated"]),b=Symbol(),x=e();function A(t,e){return t&&t.hasOwnProperty(e)?t[e]:null}function k(l,t,f){g(t,f||{}).forEach(function(t,e){var n,r,i,o,u,a,s;if(!x.empty()&&null!=x.apply({element:l,attr:e,value:t,get prev(){return A(f,e)}}))return;if("class"===e&&h(t))u=l,a=t,(s=Array.isArray(a)?d.apply(void 0,a):d(a))?u.setAttribute("class",s):u.removeAttribute("class");else if("style"===e&&h(t)){var c=A(f,e);n=l,r=t,h(i=c)?o=i:(o={},n.removeAttribute("style")),g(r,o).forEach(function(t,e){return v(n,e,t)})}else if(e.startsWith("on")){var p=e.substring(2);w(l,p,t)}else E.has(e)||(null==t||!1===t?l.removeAttribute(e):l.setAttribute(e,!0===t?"":String(t)))})}var S=function(){function t(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this.nexts=new WeakMap,this.prevs=new WeakMap,this.first=null,this.last=null,t.forEach(function(t){return e.push(t)})}return t.prototype.empty=function(){return null==this.first},t.prototype.push=function(t){this.empty()?this.first=t:(this.nexts.set(this.last,t),this.prevs.set(t,this.last)),this.last=t},t.prototype.insertBefore=function(t,e){var n=this.before(e);this.prevs.set(t,n),this.nexts.set(t,e),this.prevs.set(e,t),n&&this.nexts.set(n,t),e===this.first&&(this.first=t)},t.prototype.delete=function(t){var e=this.before(t),n=this.after(t);e&&this.nexts.set(e,n),n&&this.prevs.set(n,e),t===this.first&&(this.first=n),t===this.last&&(this.last=e)},t.prototype.before=function(t){return this.prevs.get(t)||null},t.prototype.after=function(t){return this.nexts.get(t)||null},t.prototype.loop=function(t){if(!this.empty()){var e=this.first;do{if(t(e))break}while(e=this.after(e))}},t.prototype.copy=function(){var e=new t;return this.loop(function(t){return e.push(t),!1}),e},t.prototype.forEach=function(e){this.loop(function(t){return e(t),!1})},t.prototype.find=function(e){var n=null;return this.loop(function(t){return!!e(t)&&(n=t,!0)}),n},t.prototype.map=function(e){var n=[];return this.loop(function(t){return n.push(e(t)),!1}),n},t}();function N(t,e,n){var r=t&&e&&t.matches(e);r&&t.parent()===e.parent()?n.replaceVNode(e,t):t&&n.addVNode(t);var i=n.getVNodeContext(t),o=n.getVNodeContext(e);if((e&&!r&&(e.detach(o),e.children().forEach(function(t){return N(null,t,n)}),e.detached(o)),t&&!r&&(t.attach(i),t.children().forEach(function(t){return N(t,null,n)}),t.attached(i)),r)&&t.update(e,i)!==n.LEAVE){var u=function(t,e){var n=e.children(),i=new Map,o=[];n.forEach(function(t){var e=t.key();null==e?o.push(t):i.set(e,t)});var r=t.children(),u=[],a=new Set(n),s=new Set;return r.forEach(function(t){var e=null,n=null,r=t.key();if(null!=r){if(s.has(r))throw new Error("Duplicate key");s.add(r),i.has(r)&&(n=i.get(r))}else 0<o.length&&(n=o.shift());t.matches(n)&&(e=n),u.push([t,e]),e&&a.delete(e)}),{matches:u,unmatched:a}}(t,e),a=u.matches;u.unmatched.forEach(function(t){return N(null,t,n)}),a.forEach(function(t){return N(t[0],t[1],n)}),t.updated(i)}}var C=function(t,e){return(C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function M(t,e){function n(){this.constructor=t}C(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var O=function(){return(O=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)},V=function(){function t(t){this.parentVNode=t}return t.prototype.key=function(){return null},t.prototype.parent=function(t){if(!t)return this.parentVNode;this.parentVNode=t},t.prototype.children=function(){return[]},t.prototype.attach=function(t){},t.prototype.detach=function(t){},t.prototype.update=function(t,e){return null},t.prototype.attached=function(t){},t.prototype.detached=function(t){},t.prototype.updated=function(t){},t}();function j(t,e){return t instanceof Element&&e.type===t.tagName.toLowerCase()}var D=new WeakMap;function P(t,e){var n;D.has(e)?n=D.get(e):(n=new WeakSet,D.set(e,n)),n.add(t)}function T(t,e){return D.has(e)&&D.get(e).has(t)}var W=function(r){function e(t,e){var n=r.call(this,e)||this;return n.spec=t,n}return M(e,r),e.prototype.matches=function(t){return t instanceof e&&this.spec.type===t.spec.type},e.prototype.key=function(){return this.spec.props.key},e.prototype.children=function(){return[this.child]},e.prototype.getExistingElement=function(t){var e,n=t.parent,r=t.node;if(j(r,this.spec))e=r;else if(!T(n,t.vdom)&&t.vdom.isDOMNodeCaptured(n)){var i=t.sibling,o=i?i.nextElementSibling:n.firstElementChild;o&&!t.vdom.isDOMNodeCaptured(o)&&(j(o,this.spec)?e=o:n.removeChild(o))}return e},e.prototype.attach=function(t){var e,n=this.getExistingElement(t);n?e=n:P(e=function(t,e){var n=l.apply({spec:t,parent:e});if(n)return n;var r=t.type;return"svg"===r?document.createElementNS("http://www.w3.org/2000/svg","svg"):"http://www.w3.org/1999/xhtml"===e.namespaceURI?document.createElement(r):document.createElementNS(e.namespaceURI,r)}(this.spec,t.parent),t.vdom),k(e,this.spec.props,null),this.child=q(e,this.spec.children,this)},e.prototype.update=function(t,e){var n=e.vdom.getVNodeContext(t).node;k(n,this.spec.props,t.spec.props),this.child=q(n,this.spec.children,this)},e.prototype.attached=function(t){var e=this.spec.props.attached;e&&e(t.node)},e.prototype.detached=function(t){var e=this.spec.props.detached;e&&e(t.node)},e.prototype.updated=function(t){var e=this.spec.props.updated;e&&e(t.node)},e}(V),L={ATTACHED:Symbol(),DETACHED:Symbol(),UPDATED:Symbol()},$=[[u,l],[b,x]],_=function(r){function u(t,e){var n=r.call(this,e)||this;return n.lock=!1,n.spec=t,n.prev=null,n.store={},n}return M(u,r),u.prototype.matches=function(t){return t instanceof u&&this.spec.type===t.spec.type},u.prototype.key=function(){return this.spec.props.key},u.prototype.children=function(){return[this.child]},u.prototype.createContext=function(r){var i=this,t=r.parent,e=this.spec,n=this.prev,o=this.store;return{spec:e,prev:n,store:o,get node(){return r.node},get nodes(){return r.nodes},parent:t,attached:function(t){return o[L.ATTACHED]=t},detached:function(t){return o[L.DETACHED]=t},updated:function(t){return o[L.UPDATED]=t},refresh:function(){if(i.lock)throw new Error("Calling refresh during unboxing causes infinite loop");i.prev=i.spec;var t=r.vdom.getVNodeContext(i),e=i.unbox(t);if(e!==r.vdom.LEAVE){var n=i.child;i.child=G(e,i),r.vdom.execute(i.child,n)}},leave:function(){return r.vdom.LEAVE}}},u.prototype.unbox=function(t){var e=this.spec.type,n=this.spec.props,r=this.spec.children;this.lock=!0;var i=u.context;u.context=this.createContext(t);var o=null;try{o=e.apply(void 0,[n].concat(r))}finally{u.context=i,this.lock=!1}return o},u.prototype.addPlugins=function(){s(this.spec.type,$)},u.prototype.deletePlugins=function(){p(this.spec.type,$)},u.prototype.attach=function(t){this.addPlugins();var e=this.unbox(t),n=e===t.vdom.LEAVE?null:e;this.child=G(n,this)},u.prototype.update=function(t,e){this.store=t.store,this.prev=t.spec;var n=e.vdom.getVNodeContext(t);this.addPlugins();var r=this.unbox(n),i=null;return r===e.vdom.LEAVE?(i=r,this.child=t.child,e.vdom.adoptVNode(this.child,this)):this.child=G(r,this),i},u.prototype.handle=function(t,e){var n=this.store[t];if(n){var r=0===e.nodes.length?[null]:e.nodes;n.apply(void 0,r)}},u.prototype.attached=function(t){this.deletePlugins(),this.handle(L.ATTACHED,t)},u.prototype.detached=function(t){this.handle(L.DETACHED,t)},u.prototype.updated=function(t){this.deletePlugins(),this.handle(L.UPDATED,t)},u.context=null,u}(V);function U(){return _.context}var F=function(r){function e(t,e){var n=r.call(this,e)||this;return n.text=t,n}return M(e,r),e.prototype.matches=function(t){return t instanceof e},e.prototype.children=function(){return[this.child]},e.prototype.getExistingNode=function(t){var e,n=t.parent;if(t.node instanceof Text)e=t.node;else if(!T(n,t.vdom)&&t.vdom.isDOMNodeCaptured(n)){var r=t.sibling,i=r?r.nextSibling:n.firstChild;i&&!t.vdom.isDOMNodeCaptured(i)&&i instanceof Text&&(e=i)}return e},e.prototype.attach=function(t){var e,n=this.getExistingNode(t);n?(e=n).textContent=this.text:e=document.createTextNode(this.text),this.child=G(e,this)},e.prototype.update=function(t,e){var n=e.vdom.getVNodeContext(t).node;this.text!==t.text&&(n.textContent=this.text),this.child=G(n,this)},e}(V),H=function(r){function e(t,e){var n=r.call(this,e)||this;return n.fn=t,n}return M(e,r),e.prototype.matches=function(t){return t instanceof e},e.prototype.children=function(){return[this.child]},e.prototype.call=function(t){var e=(0,this.fn)({parent:t.parent,get node(){return t.node},get nodes(){return t.nodes}});this.child=G(e,this)},e.prototype.attach=function(t){this.call(t)},e.prototype.update=function(t,e){var n=e.vdom.getVNodeContext(t);this.call(n)},e}(V),I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return M(e,t),e.prototype.matches=function(t){return t instanceof e},e}(V),z=function(i){function e(t,e,n){var r=i.call(this,n)||this;return r.node=t,r.childSpecs=e,r}return M(e,i),e.prototype.matches=function(t){return t instanceof e&&this.node===t.node},e.prototype.wrap=function(){var e=this;this.childVNodes=this.childSpecs.map(function(t){return G(t,e)})},e.prototype.insertNode=function(t){var e=t.parent,n=t.sibling;if(!(e===this.node.parentElement&&n===this.node.previousSibling)){var r=n?n.nextSibling:e.firstChild;e.insertBefore(this.node,r)}},e.prototype.attach=function(t){this.wrap(),this.insertNode(t)},e.prototype.detach=function(t){t.parent.removeChild(this.node)},e.prototype.update=function(t,e){this.wrap(),this.insertNode(e)},e.prototype.refine=function(t){for(var e=this.node,n=e.lastChild;null!=n;)if(t.vdom.isDOMNodeCaptured(n))n=n.previousSibling;else{var r=n.previousSibling;e.removeChild(n),n=r}P(e,t.vdom)},e.prototype.attached=function(t){var e=this.node;e instanceof Element&&!T(e,t.vdom)&&t.vdom.isDOMNodeCaptured(e)&&this.refine(t)},e.prototype.children=function(){return this.childVNodes},e}(V);function B(t){return t instanceof z}function q(t,e,n){return new z(t,e,n)}var R=function(i){function e(t,e,n){var r=i.call(this,n)||this;return r.items=t,r.id=e,r}return M(e,i),e.prototype.matches=function(t){return t instanceof e},e.prototype.key=function(){return this.id},e.prototype.children=function(){return this.childVNodes},e.prototype.wrap=function(){var e=this;this.childVNodes=this.items.map(function(t){return G(t,e)})},e.prototype.attach=function(){this.wrap()},e.prototype.update=function(){this.wrap()},e}(V);function G(t,e){if(i(t))return new W(t,e);if(o(t))return t.type===Array?new R(t.children,t.props.key,e):new _(t,e);if("string"==typeof t)return new F(t,e);if(null==t)return new I(e);if("function"==typeof t)return new H(t,e);if(t instanceof Node)return q(t,[],e);if(Array.isArray(t))return new R(t,null,e);throw new Error("Unable to create virtual node for spec")}function J(i){var u=new WeakMap,a=new WeakMap,s=new WeakMap,c=new WeakMap,p=new WeakSet;function l(n){var r=s.get(n);u.set(n,{parent:r,get node(){var t=c.get(n).find(function(t){return null!=t.node});return t?t.node:null},get nodes(){return c.get(n).map(function(t){return t.node}).filter(function(t){return t})},get sibling(){if(r===i.parentElement)return c.get(n).first.node.previousSibling;for(var t=a.get(r),e=c.get(n).first;e=t.links.before(e);)if(e.node)return e.node;return null},vdom:o})}function f(t){var e,n,r;null==t.parent()?(e=t,n=i.parentElement||document.createDocumentFragment(),r=new S({parentNode:n,node:i}),c.set(e,r.copy()),s.set(e,n),a.set(n,{node:n,links:r})):function(t){var e=t.parent(),n=p.has(e),r=B(e)?e.node:s.get(e);s.set(t,r);var i=new S;if(c.set(t,i),n){for(var o={parentNode:r,node:null},u=t;c.get(u).push(o),(u=u.parent())&&!B(u););a.get(r).links.push(o)}else p.add(e),(B(e)?a.get(r).links:c.get(e)).forEach(function(t){return i.push(t)})}(t),function(t){if(B(t)){var e=t.node;a.set(e,{node:e,links:new S({parentNode:e,node:null})}),c.get(t).forEach(function(t){return t.node=e})}}(t),l(t)}function h(t){for(var e=s.get(t),n=a.get(e),r=[],i=t;(i=i.parent())&&!B(i);)r.push(c.get(i));return r.push(n.links),r}var o={execute:function(t,e){N(t,e,o)},addVNode:f,getVNodeContext:function(t){return u.get(t)},replaceVNode:function(t,e){if(null!=e.parent()){var n=u.get(t).parent;s.set(e,n);var r=c.get(t),i={parentNode:n,node:null};h(e).forEach(function(e){var t=e.after(r.last);r.forEach(function(t){return e.delete(t)}),t?e.insertBefore(i,t):e.push(i)});var o=new S(i);c.set(e,o),l(e)}else f(e)},adoptVNode:function(t,e){var n=c.get(t),r=c.get(e).copy();t.parent(e),h(t).forEach(function(e){n.forEach(function(t){return e.insertBefore(t,r.first)}),r.forEach(function(t){return e.delete(t)})})},isDOMNodeCaptured:function(t){return a.has(t)&&t!==i.parentElement},LEAVE:Symbol()};return o}var K=new WeakMap,Q=new WeakMap;function X(t,e){var n,r=K.get(t)||null;return K.set(t,e),Q.has(t)?n=Q.get(t):(n=J(t),Q.set(t,n)),n.execute(e,r),n.getVNodeContext(e)}var Y={createElement:r(u),setAttribute:r(b)},Z=Object.freeze({plugins:Y,render:function(t,e){return X(t,q(t,Array.isArray(e)?e:[e],null)),t},sync:function(t,e){var n=X(t,G(e,null)).nodes;if(1!==n.length||n[0]!==t)throw new Error("Spec does not match the node");return n[0]},teardown:function(t){K.delete(t),Q.delete(t)},getContext:U});function tt(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}var et=Symbol(),nt=e();var rt=Symbol(),it=e(),ot=new Set(["key","attached","detached","updated"]);var ut=Symbol(),at=e();var st=new Set(["area","base","br","col","embed","hr","img","input","link","menuitem","meta","param","source","track","wbr"]),ct=null;var pt=[[et,nt],[rt,it],[ut,at]],lt=function(){};function ft(t,e){return"".padEnd(t.length*e,t)}var ht=function(e){function t(t){var r=e.call(this)||this;return r.children=[],r.tag=t.type,r.attrs=new Map,Object.entries(t.props).filter(function(t){return!function(t,e){if(!it.empty()){var n=it.apply({attr:t,value:e});if(null!=n)return n}return ot.has(t)||t.startsWith("on")||null==e||!1===e}(t[0],t[1])}).forEach(function(t){var e=t[0],n=t[1];return r.attrs.set(e,function(t,e){if(!nt.empty()){var n=nt.apply({attr:t,value:e});if(null!=n)return n}return"class"===t&&h(e)?tt(Array.isArray(e)?d.apply(void 0,e):d(e)):"style"===t&&h(e)?tt(f(e)):!0===e?"":tt(String(e))}(e,n))}),r.isVoid=function(t){if(!at.empty()){var e=at.apply(t);if(null!=e)return e}return st.has(t)}(r.tag),r}return M(t,e),t.prototype.stringify=function(t){var e=t.indent,n=t.depth,r=[],i=ft(e,n),o=Array.from(this.attrs.entries()).map(function(t){var e=t[0],n=t[1];return""===n?e:e+'="'+n+'"'}).join(" "),u=i+"<"+this.tag+(o?" "+o:"")+">";if(this.isVoid)r.push(u);else{var a="</"+this.tag+">";0===this.children.length?r.push(""+u+a):1===this.children.length&&this.children[0]instanceof dt&&!this.children[0].text.includes("\n")?r.push(""+u+this.children[0].stringify({indent:e,depth:0})+a):(r.push(u),this.children.forEach(function(t){return r.push(t.stringify({indent:e,depth:n+1}))}),r.push(""+i+a))}return r.join("\n")},t}(lt),dt=function(n){function t(t){var e=n.call(this)||this;return e.text=tt(t),e}return M(t,n),t.prototype.stringify=function(t){var e=ft(t.indent,t.depth);return""+e+this.text.replace(/\n/g,"\n"+e)},t}(lt),vt=function(n){function t(t){var e=n.call(this)||this;return e.text=tt(t),e}return M(t,n),t.prototype.stringify=function(t){return ft(t.indent,t.depth)+"\x3c!--"+this.text+"--\x3e"},t}(lt);function yt(t,e){if(i(t)){var n=new ht(t);e.children.push(n),t.children.forEach(function(t){return yt(t,n)})}else if(o(t)){if(t.type===Array)t.children.forEach(function(t){return yt(t,e)});else s(t.type,pt),yt(function(t){var e=t.type,n=t.props,r=t.children,i=ct;ct={};var o=e.apply(void 0,[n].concat(r));return ct=i,o}(t),e),p(t.type,pt)}else if("string"==typeof t){var r=new dt(t);e.children.push(r)}else if(null==t){r=new vt("");e.children.push(r)}else{if(!Array.isArray(t))throw new Error("Unable to stringify spec");t.forEach(function(t){return yt(t,e)})}}var mt={stringifyAttribute:r(et),skipAttribute:r(rt),isVoidTag:r(ut)};var gt=Object.freeze({stringify:function(t,e){var n,r,i=void 0===e?{}:e,o=i.indent,u=void 0===o?"    ":o,a=i.depth,s=void 0===a?0:a;if(c(t))return(n=t,r=new ht({type:"div",props:{},children:[]}),yt(n,r),r.children).map(function(t){return t.stringify({indent:u,depth:s})}).join("\n");throw new Error("Not a spec")},plugins:mt,isStringifying:function(){return null!=ct},escapeHTML:tt});function wt(t,e,n){return e*(1-t)+n*t}var Et=function(e,n){return function(t){return wt(t,e,n)}};function bt(t){for(var e,n=[],r=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[e][-+]?\d+)?/gim;e=r.exec(t);)n.push({index:e.index,length:e[0].length});return n}var xt=function(i,o){var u=bt(i),a=bt(o);return function(t){for(var e="",n=0,r=0;r<a.length;r++)e+=o.substring(n,a[r].index),e+=wt(t,parseFloat(i.substr(u[r].index,u[r].length)),parseFloat(o.substr(a[r].index,a[r].length))).toString(),n=a[r].index+a[r].length;return e+=o.substring(n)}};function At(t){return t}var kt={delay:0,duration:250,easing:"ease"},St=function(){function t(){this.$spec={initial:null,timeline:[],interpolate:null,output:At}}return t.prototype.initial=function(t){return this.$spec.initial=t,this},t.prototype.from=function(t){if(0<this.$spec.timeline.length)throw new Error("Starting keyframe was already declared");return this.$spec.timeline.push({from:t,to:null,timing:O({},kt)}),this},t.prototype.to=function(t,e){this.$spec.interpolate||("number"==typeof t?this.$spec.interpolate=Et:"string"==typeof t&&(this.$spec.interpolate=xt));var n=m(this.$spec.timeline);return n&&null==n.to?(n.to=t,e&&(n.timing=O({},n.timing,e))):this.$spec.timeline.push({from:n?n.to:null,to:t,timing:O({},kt,e||{})}),this},t.prototype.interpolate=function(t){return this.$spec.interpolate=t,this},t.prototype.output=function(t){return this.$spec.output=t,this},t.prototype.spec=function(){return this.$spec},t}();var Nt={linear:function(t){return t},ease:function(t){var e=(1-Math.cos(t*Math.PI))/2,n=Math.sqrt(1-Math.pow(t-1,2)),r=Math.sin(t*Math.PI/2);return e*(1-r)+n*r},"ease-in":function(t){var e=1-Math.cos(t*Math.PI/2);return 1-1e-15<e?1:e},"ease-out":function(t){return Math.sin(t*Math.PI/2)},"ease-in-out":function(t){return(1-Math.cos(t*Math.PI))/2}},Ct=function(){function t(t,e){if(!t.interpolate)throw new Error("No interpolator provided");this.interpolate=t.interpolate,this.output=t.output,this.callback=e;var i=0;this.timeline=t.timeline.map(function(t){var e=i,n=e+t.timing.delay,r=n+t.timing.duration;return{standby:e,start:n,end:i=r,spec:t,interpolate:null}}),this.isComplete=!1}return t.prototype.tick=function(t){null==this.startTime&&(this.startTime=t);for(var e,n=t-this.startTime,r=this.timeline,i=r.length-1;0<=i;i--){var o=r[i],u=o.standby,a=o.end;if(a<=n||u<=n&&n<=a){e=r[i];break}}var s=e.start,c=e.end,p=e.spec;e===m(r)&&c<=n&&(this.isComplete=!0),e.interpolate||(e.interpolate=this.interpolate(p.from,p.to));var l,f,h,d=("string"==typeof p.timing.easing?Nt[p.timing.easing]:p.timing.easing)(n<s?0:s===c?1:(l=(n-s)/(c-s),f=0,h=1,Math.min(h,Math.max(f,l)))),v=e.interpolate.call(null,d);this.lastValue=v;var y=this.output.call(null,v);this.callback.call(null,y)},t.prototype.value=function(){return this.lastValue},t.prototype.complete=function(){return this.isComplete},t}();var Mt=function(){var e=null,t=null,n=!1,r=[];function i(){e=performance.now(),r.forEach(function(t){return t(e)}),n&&(t=requestAnimationFrame(i))}return{run:function(){n=!0,e=performance.now(),t=requestAnimationFrame(i)},stop:function(){cancelAnimationFrame(t),e=t=null,n=!1},tick:function(t){r.push(t)},time:function(){return e},running:function(){return n}}}();function Ot(t,e){t.tick(e),t.complete()&&Dt(t)}Mt.tick(function(e){return Array.from(jt.values()).forEach(function(t){return Ot(t,e)})});var Vt=new WeakMap,jt=new Set;function Dt(t){jt.delete(t),0===jt.size&&Mt.stop()}function Pt(t){var e=Vt.get(t);return e&&jt.has(e)?e:null}function Tt(t){return a(t)&&Object.values(t).some(function(t){return t instanceof St})}function Wt(t,e,n){var r,i,o,u,a,s=t.spec(),c=s.timeline[0].from,p=m(s.timeline).to;if(e instanceof St){var l=Pt(e);if(l)Dt(l),r=l.value();else r=m(e.spec().timeline).to}else typeof e==typeof p&&null!=e&&null!=p&&e.constructor===p.constructor&&(r=e);(null!=c?i=c:null!=r?i=r:null!=s.initial&&(i=s.initial),null==i)?n(s.output(p)):(s.timeline[0].from=i,u=n,a=new Ct((o=t).spec(),u),jt.add(a),Vt.set(o,a),!Mt.running()&&Mt.run(),Ot(a,Mt.time()))}function Lt(t){if(t instanceof St){var e=Pt(t);e&&Dt(e)}}var $t=function(t){var e=t.element,n=t.attr,r=t.value,i=t.prev;return r instanceof St?(Wt(r,i,function(t){return e.setAttribute(n,t)}),!0):(Tt(i)?Object.values(i).forEach(function(t){return Lt(t)}):Lt(i),null)},_t=function(t){var i=t.element,e=t.attr,n=t.value,r=t.prev;if("style"===e){if(Tt(n)){var o,u=n;return a(r)?(o=r,Object.keys(o).filter(function(t){return!u.hasOwnProperty(t)}).forEach(function(t){Lt(o[t]),v(i,t,null)})):(o={},i.removeAttribute("style"),Lt(r)),Object.entries(u).forEach(function(t){var e=t[0],n=t[1],r=o[e];n instanceof St?Wt(n,r,function(t){v(i,e,t)}):(Lt(r),v(i,e,n))}),!0}Tt(r)&&Object.values(r).forEach(function(t){return Lt(t)})}return null};function Ut(t){return t.output(null!=t.timeline[0].from?t.timeline[0].from:null!=t.initial?t.initial:m(t.timeline).to)}var Ft=function(t){var e=t.value;if(e instanceof St){var n=e.spec();return tt(String(Ut(n)))}return null},Ht=function(t){var e=t.attr,r=t.value;if("style"===e&&Tt(r)){var i={};return Object.keys(r).forEach(function(t){var e=r[t];if(e instanceof St){var n=e.spec();i[t]=Ut(n)}else i[t]=e}),tt(f(i))}return null};var It=Object.freeze({animate:function(t,e){var n=new St;return null!=t&&n.to(t,e),n},withAnimation:function(t){if(Z){var e=Y;e.setAttribute.add(t,$t),e.setAttribute.add(t,_t)}if(gt){var n=mt;n.stringifyAttribute.add(t,Ft),n.stringifyAttribute.add(t,Ht)}return t}}),zt=[],Bt=null;function qt(e,t){if(null!=t)if(o(t))t.type===Array?t.children.forEach(function(t){return qt(e,t)}):function(t,e){var n=e.type,r=e.props,i=e.children;s(n,zt);var o=Bt;qt(Bt=t,n.apply(void 0,[r].concat(i))),Bt=o,p(n,zt)}(e,t);else if(Array.isArray(t))t.forEach(function(t){return qt(e,t)});else{if("function"!=typeof t)throw new Error("Unable to draw spec");t(e)}}var Rt=Object.freeze({draw:qt,getContext:function(){return Bt}});var Gt=Object.freeze({withForms:function(t){return Y.setAttribute.add(t,function(t){var e=t.element,n=t.attr,r=t.value;if("value"===n&&e instanceof HTMLInputElement){var i=e.value=null==r?"":r;return e.value=i,!0}return null}),t}}),Jt=null;var Kt=Object.freeze({useState:function(t){if(!Jt)throw new Error("`useState()` should be called inside a component");return Jt(t)},withState:function(a){return function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=U(),o=!0,u=Jt;Jt=function(t){if(!i)return{state:t,setState:null};var e=i.store,n=i.refresh;return e.state=e.state||t,{state:e.state,setState:function(t){if(o)throw new Error("Setting state during unboxing causes infinite loop");e.state=O({},e.state,t),n()}}};try{r=a.apply(void 0,[t].concat(e))}finally{Jt=u,o=!1}return r}}});t.Animation=It,t.Canvas=Rt,t.DOM=Z,t.Forms=Gt,t.State=Kt,t.String=gt,t.m=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(e=e||{},"string"==typeof t)return{type:t,props:e,children:n};if("function"!=typeof t)throw new Error("Unsupported spec type");return{type:t,props:e,children:n}},Object.defineProperty(t,"__esModule",{value:!0})});
