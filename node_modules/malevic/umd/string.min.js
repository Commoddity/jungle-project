/* malevic@0.16.3 - Jul 22, 2019 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(((t=t||self).Malevic=t.Malevic||{},t.Malevic.String={}))}(this,function(t){"use strict";function n(){var u=[];return{add:function(t){return u.push(t),this},apply:function(t){for(var n,r,e=new Set,i=u.length-1;0<=i;i--)if(r=u[i],!e.has(r)){if(null!=(n=r(t)))return n;e.add(r)}return null},delete:function(t){for(var n=u.length-1;0<=n;n--)if(u[n]===t){u.splice(n,1);break}return this},empty:function(){return 0===u.length}}}function o(e,t,i){t.filter(function(t){var n=t[0];return e[n]}).forEach(function(t){var n=t[0],r=t[1];return e[n].forEach(function(t){return i(r,t)})})}function r(r){var e={add:function(t,n){return t[r]||(t[r]=[]),t[r].push(n),e}};return e}function i(t){return null!=t&&"object"==typeof t}function f(t){return i(t)&&null!=t.type&&null==t.nodeType}function u(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=[];return t.filter(function(t){return Boolean(t)}).forEach(function(n){"string"==typeof n?r.push(n):"object"==typeof n&&r.push.apply(r,Object.keys(n).filter(function(t){return Boolean(n[t])}))}),r.join(" ")}function c(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}var e=Symbol(),a=n();function l(t,n){if(!a.empty()){var r=a.apply({attr:t,value:n});if(null!=r)return r}var e;return"class"===t&&i(n)?c(Array.isArray(n)?u.apply(void 0,n):u(n)):"style"===t&&i(n)?c((e=n,Object.keys(e).filter(function(t){return null!=e[t]}).map(function(t){return t+": "+e[t]+";"}).join(" "))):!0===n?"":c(String(n))}var p=Symbol(),s=n(),h=new Set(["key","attached","detached","updated"]);var d=function(t,n){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var r in n)n.hasOwnProperty(r)&&(t[r]=n[r])})(t,n)};function y(t,n){function r(){this.constructor=t}d(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var v=Symbol(),g=n();var b=new Set(["area","base","br","col","embed","hr","img","input","link","menuitem","meta","param","source","track","wbr"]),m=null;var w=[[e,a],[p,s],[v,g]],j=function(){};function E(t,n){return"".padEnd(t.length*n,t)}var x=function(n){function t(t){var e=n.call(this)||this;return e.children=[],e.tag=t.type,e.attrs=new Map,Object.entries(t.props).filter(function(t){return!function(t,n){if(!s.empty()){var r=s.apply({attr:t,value:n});if(null!=r)return r}return h.has(t)||t.startsWith("on")||null==n||!1===n}(t[0],t[1])}).forEach(function(t){var n=t[0],r=t[1];return e.attrs.set(n,l(n,r))}),e.isVoid=function(t){if(!g.empty()){var n=g.apply(t);if(null!=n)return n}return b.has(t)}(e.tag),e}return y(t,n),t.prototype.stringify=function(t){var n=t.indent,r=t.depth,e=[],i=E(n,r),u=Array.from(this.attrs.entries()).map(function(t){var n=t[0],r=t[1];return""===r?n:n+'="'+r+'"'}).join(" "),o=i+"<"+this.tag+(u?" "+u:"")+">";if(this.isVoid)e.push(o);else{var c="</"+this.tag+">";0===this.children.length?e.push(""+o+c):1===this.children.length&&this.children[0]instanceof _&&!this.children[0].text.includes("\n")?e.push(""+o+this.children[0].stringify({indent:n,depth:0})+c):(e.push(o),this.children.forEach(function(t){return e.push(t.stringify({indent:n,depth:r+1}))}),e.push(""+i+c))}return e.join("\n")},t}(j),_=function(r){function t(t){var n=r.call(this)||this;return n.text=c(t),n}return y(t,r),t.prototype.stringify=function(t){var n=E(t.indent,t.depth);return""+n+this.text.replace(/\n/g,"\n"+n)},t}(j),A=function(r){function t(t){var n=r.call(this)||this;return n.text=c(t),n}return y(t,r),t.prototype.stringify=function(t){return E(t.indent,t.depth)+"\x3c!--"+this.text+"--\x3e"},t}(j);function S(t,n){if(f(u=t)&&"string"==typeof u.type){var r=new x(t);n.children.push(r),t.children.forEach(function(t){return S(t,r)})}else if(f(i=t)&&"function"==typeof i.type){if(t.type===Array)t.children.forEach(function(t){return S(t,n)});else o(t.type,w,function(t,n){return t.add(n)}),S(function(t){var n=t.type,r=t.props,e=t.children,i=m;m={};var u=n.apply(void 0,[r].concat(e));return m=i,u}(t),n),o(t.type,w,function(t,n){return t.delete(n)})}else if("string"==typeof t){var e=new _(t);n.children.push(e)}else if(null==t){e=new A("");n.children.push(e)}else{if(!Array.isArray(t))throw new Error("Unable to stringify spec");t.forEach(function(t){return S(t,n)})}var i,u}var O={stringifyAttribute:r(e),skipAttribute:r(p),isVoidTag:r(v)};t.escapeHTML=c,t.isStringifying=function(){return null!=m},t.plugins=O,t.stringify=function(t,n){var r,e,i=void 0===n?{}:n,u=i.indent,o=void 0===u?"    ":u,c=i.depth,a=void 0===c?0:c;if(f(t))return(r=t,e=new x({type:"div",props:{},children:[]}),S(r,e),e.children).map(function(t){return t.stringify({indent:o,depth:a})}).join("\n");throw new Error("Not a spec")},Object.defineProperty(t,"__esModule",{value:!0})});
